function [Polaritons] = TwoResonanceEngine(x,Angle) %x is the sextuplet [w1,w2,O1,O2,neff,E0]

syms w1 w2 O10 O20 neff E0 O1 O2 D wcav

w1 = x(1);
w2 = x(2);
O10 = x(3);
O20 = x(4);
neff = x(5);
E0 = x(6);

O1 = O10*(w1/wcav)^(1/2);
O2 = O20*(w2/wcav)^(1/2);
D = (O1^2)/(4*w1)+(O2^2)/(4*w2);

if size(Angle,1) == 1

	Angle = transpose(Angle);

numberAngles = size(Angle,1);

wcavAll = photonDispersionModel(neff,Angle,E0);

Polaritons = zeros(numberAngles,3);

for i = 1 : numberAngles
  
wcav = wcavAll(i);
%LP
Polaritons(i,1) = real((((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)/(2*((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3)) - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3)/2 + O10^2/3 + O20^2/3 + w1^2/3 + w2^2/3 + wcav^2/3 + (3^(1/2)*(((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)/((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3) + ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3))*1i)/2)^(1/2));
%MP
Polaritons(i,2) = real((((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)/(2*((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3)) - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3)/2 + O10^2/3 + O20^2/3 + w1^2/3 + w2^2/3 + wcav^2/3 - (3^(1/2)*(((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)/((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3) + ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3))*1i)/2)^(1/2));
%UP
Polaritons(i,3) = real((((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3) - ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)/((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^3/27 - ((O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)*(O10^2*w2^2 + O20^2*w1^2 + w1^2*w2^2 + w1^2*wcav^2 + w2^2*wcav^2))/6 + (w1^2*w2^2*wcav^2)/2)^2 + ((w1^2*w2^2)/3 + (w1^2*wcav^2)/3 + (w2^2*wcav^2)/3 - (O10^2 + O20^2 + w1^2 + w2^2 + wcav^2)^2/9 + (O10^2*w2^2)/3 + (O20^2*w1^2)/3)^3)^(1/2) + (w1^2*w2^2*wcav^2)/2)^(1/3) + O10^2/3 + O20^2/3 + w1^2/3 + w2^2/3 + wcav^2/3)^(1/2));

end

end

